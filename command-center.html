<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KMG COMMAND CENTER | HIERARCHICAL SCRUM v12.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@100;300;400;500;600;700;800;900&family=Outfit:wght@100;300;400;500;700;900&family=Space+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00f2fe;
            --accent: #8b5cf6;
            --danger: #ff4d4d;
            --warning: #fbbf24;
            --bg: #020205;
            --panel: rgba(10, 10, 15, 0.85);
            --border: rgba(255, 255, 255, 0.08);
            --text: #f8fafc;
            --text-muted: #475569;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Pretendard', sans-serif; }
        body { 
            background-color: var(--bg); 
            color: var(--text); 
            height: 100vh; 
            overflow: hidden; 
            display: flex;
            position: relative;
        }

        /* --- Harry Potter Wand Effect --- */
        .wand-light {
            position: fixed;
            top: 0; left: 0;
            width: 400px; height: 400px;
            background: radial-gradient(circle at center, rgba(0, 242, 254, 0.15) 0%, transparent 70%);
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            mix-blend-mode: screen;
        }

        .ambient-glow {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.02) 0%, rgba(0, 242, 254, 0.02) 100%);
            z-index: -1;
            animation: pulseGlow 10s infinite alternate;
        }
        @keyframes pulseGlow { from { opacity: 0.5; } to { opacity: 1; } }

        #app {
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            width: 100%;
            height: 100vh;
            padding: 20px;
            gap: 20px;
        }

        .glass-panel {
            background: var(--panel);
            backdrop-filter: blur(50px);
            border: 1px solid var(--border);
            border-radius: 30px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 30px 60px rgba(0,0,0,0.5);
        }

        /* --- Left Sidebar --- */
        .sidebar-left { padding: 25px; gap: 15px; }
        .nav-btn {
            padding: 14px 20px; border-radius: 12px; cursor: pointer; display: flex; align-items: center; gap: 12px;
            font-weight: 600; transition: 0.3s; color: var(--text-muted); font-size: 0.9rem;
        }
        .nav-btn.active { background: rgba(0, 242, 254, 0.1); border: 1px solid var(--primary); color: var(--primary); }

        .timer-widget { margin-top: auto; padding: 20px; background: rgba(255,255,255,0.02); border-radius: 20px; border: 1px solid var(--border); }
        .timer-val { font-family: 'Space Mono'; font-size: 1.8rem; text-align: center; color: var(--primary); margin-bottom: 10px; }
        .timer-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        .t-btn { padding: 8px; border-radius: 8px; border: 1px solid var(--border); background: transparent; color: #fff; cursor: pointer; font-size: 0.6rem; }
        .timer-input { width: 100%; background: transparent; border: 1px solid var(--border); color: #fff; border-radius: 8px; padding: 5px; margin-top: 5px; text-align: center; font-size: 0.7rem; }

        /* --- Main Area --- */
        .main-content { padding: 30px; display: flex; flex-direction: column; overflow: hidden; }
        .view-section { display: none; height: 100%; flex-direction: column; overflow: hidden; }
        .view-section.active { display: flex; }

        .v-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-shrink: 0; }
        .v-header h2 { font-family: 'Outfit'; font-size: 2rem; }

        /* Hierarchical List Styles */
        .data-list { flex-grow: 1; overflow-y: auto; padding-right: 10px; display: flex; flex-direction: column; gap: 10px; }
        .card { 
            background: rgba(255,255,255,0.02); border: 1px solid var(--border); padding: 15px 20px; border-radius: 15px;
            display: flex; align-items: center; gap: 15px; transition: 0.2s;
        }
        .card:hover { border-color: var(--primary); background: rgba(255,255,255,0.04); }
        .card.done { opacity: 0.3; }
        .card.done .c-text { text-decoration: line-through; }
        .check-btn { width: 22px; height: 22px; border: 2px solid var(--border); border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .card.done .check-ring { background: var(--primary); border: none; }
        
        .c-parent { font-size: 0.65rem; color: var(--accent); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 2px; display: block; }
        .c-text { font-weight: 500; font-size: 0.95rem; }

        /* --- Monthly Calendar Specific (No Scroll) --- */
        .calendar-grid { 
            display: grid; grid-template-columns: repeat(7, 1fr); grid-template-rows: auto repeat(5, 1fr); 
            gap: 8px; flex-grow: 1; height: 100%;
        }
        .cal-day-label { text-align: center; font-size: 0.7rem; color: var(--text-muted); font-weight: 800; padding: 5px; }
        .cal-cell { 
            border: 1px solid var(--border); border-radius: 12px; padding: 10px; font-size: 0.8rem;
            display: flex; flex-direction: column; gap: 4px; overflow: hidden;
        }
        .cal-cell.today { border-color: var(--primary); background: rgba(0, 242, 254, 0.05); }
        .cal-cell.holiday { color: var(--danger); }
        .m-item { background: var(--accent); color: #fff; font-size: 0.6rem; padding: 2px 5px; border-radius: 4px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; cursor: pointer; }
        .m-item.done { text-decoration: line-through; opacity: 0.5; }

        /* --- Inputs --- */
        .input-row { display: flex; gap: 10px; margin-top: 20px; background: rgba(255,255,255,0.02); padding: 15px; border-radius: 15px; flex-shrink: 0; }
        .v-input { background: rgba(0,0,0,0.2); border: 1px solid var(--border); color: #fff; padding: 10px 15px; border-radius: 10px; outline: none; font-size: 0.85rem; }
        .v-select { background: rgba(0,0,0,0.2); border: 1px solid var(--border); color: #fff; border-radius: 10px; padding: 10px; outline: none; font-size: 0.85rem; }
        .btn-add { background: var(--primary); color: #000; font-weight: 800; border: none; padding: 0 20px; border-radius: 10px; cursor: pointer; }

        /* --- Sidebar Right --- */
        .sidebar-right { padding: 25px; gap: 20px; }
        .brief-node { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 20px; border: 1px solid var(--border); }
        .brief-lbl { font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 5px; display: block; }
        .brief-val { font-weight: 700; color: var(--primary); font-size: 1rem; }

        /* Modal */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 10000; }
        .modal-body { background: #0a0a0a; border: 1px solid var(--primary); border-radius: 30px; padding: 40px; width: 600px; }

    </style>
</head>
<body onmousemove="handleMouse(event)">
    <div class="ambient-glow"></div>
    <div class="wand-light" id="wand"></div>

    <main id="app">
        <section class="glass-panel sidebar-left">
            <h2 style="font-family:'Outfit'; font-size:1.2rem; color:var(--primary); margin-bottom:20px;">AI SCRUM v12</h2>
            <div class="nav-btn active" onclick="switchTab('daily')"><span>üìå</span> DAILY (ÏÜåÌï≠Î™©)</div>
            <div class="nav-btn" onclick="switchTab('weekly')"><span>üìä</span> WEEKLY (Ï§ëÌï≠Î™©)</div>
            <div class="nav-btn" onclick="switchTab('monthly')"><span>üóìÔ∏è</span> MONTHLY (ÎåÄÌï≠Î™©)</div>

            <div class="timer-widget">
                <div class="timer-val" id="timer-txt">25:00</div>
                <input type="number" id="timer-set" class="timer-input" placeholder="Î∂Ñ ÏÑ§Ï†ï (Ïòà: 25)">
                <div class="timer-btns" style="margin-top:10px;">
                    <button class="t-btn" id="t-toggle" onclick="toggleTimer()">START</button>
                    <button class="t-btn" onclick="resetTimer()">RESET</button>
                </div>
            </div>
        </section>

        <section class="glass-panel main-content">
            <!-- DAILY -->
            <div id="v-daily" class="view-section active">
                <div class="v-header">
                    <h2>Daily Task (ÏÜå)</h2>
                    <button class="btn-add" style="height:40px; background:var(--accent); color:#fff;" onclick="genReport('daily')">REPORT</button>
                </div>
                <div class="data-list" id="daily-list"></div>
                <div class="input-row">
                    <input type="text" id="d-time" class="v-input" style="width:80px;" placeholder="09:00">
                    <input type="text" id="d-txt" class="v-input" style="flex:1;" placeholder="ÏÜåÌï≠Î™© ÏûëÏóÖ ÏûÖÎ†•">
                    <select id="d-parent" class="v-select" style="width:140px;"></select>
                    <button class="btn-add" onclick="addDaily()">ADD</button>
                </div>
            </div>

            <!-- WEEKLY -->
            <div id="v-weekly" class="view-section">
                <div class="v-header">
                    <h2>Weekly Objective (Ï§ë)</h2>
                    <button class="btn-add" style="height:40px; background:var(--accent); color:#fff;" onclick="genReport('weekly')">REPORT</button>
                </div>
                <div class="data-list" id="weekly-list"></div>
                <div class="input-row" style="flex-wrap:wrap;">
                    <select id="w-day" class="v-select"><option>Mon</option><option>Tue</option><option>Wed</option><option>Thu</option><option>Fri</option><option>Sat</option><option>Sun</option></select>
                    <input type="text" id="w-txt" class="v-input" style="flex:1;" placeholder="Ï§ëÌï≠Î™© Î™©Ìëú ÏûÖÎ†•">
                    <select id="w-prio" class="v-select"><option value="low">Low</option><option value="mid">Mid</option><option value="high">High</option></select>
                    <select id="w-parent" class="v-select" style="width:120px;"></select>
                    <button class="btn-add" onclick="addWeekly()">ADD</button>
                </div>
            </div>

            <!-- MONTHLY -->
            <div id="v-monthly" class="view-section">
                <div class="v-header">
                    <h2>Monthly Project (ÎåÄ)</h2>
                    <button class="btn-add" style="height:40px; background:var(--accent); color:#fff;" onclick="genReport('monthly')">REPORT</button>
                </div>
                <div class="calendar-grid" id="cal-grid"></div>
                <div class="input-row">
                    <input type="date" id="m-date" class="v-input" style="width:140px;">
                    <input type="text" id="m-txt" class="v-input" style="flex:1;" placeholder="ÎåÄÌï≠Î™© ÌîÑÎ°úÏ†ùÌä∏ ÏûÖÎ†•">
                    <button class="btn-add" onclick="addMonthly()">ADD</button>
                </div>
            </div>
        </section>

        <section class="glass-panel sidebar-right">
            <div class="brief-node">
                <span class="brief-lbl">TIMELINE BRIEFING</span>
                <p id="b-clock" style="font-family:'Space Mono'; font-size:1.8rem; margin:10px 0;">21:40</p>
                <div style="display:flex; justify-content:space-between; font-size:0.75rem;">
                    <span id="b-weather">Seoul: üå¶Ô∏è 6¬∞C</span>
                    <span id="b-date">Feb 13, Fri</span>
                </div>
            </div>

            <div class="brief-node" style="flex-grow:1; overflow-y:auto;">
                <span class="brief-lbl">LIVE AI NEWS</span>
                <div id="news-root" style="display:flex; flex-direction:column; gap:10px;"></div>
            </div>
        </section>
    </main>

    <div class="modal" id="modal">
        <div class="modal-body">
            <h2 id="m-title" style="color:var(--primary); margin-bottom:20px;">REPORT</h2>
            <div id="m-content" style="line-height:1.7; color:#ccc;"></div>
            <button onclick="document.getElementById('modal').style.display='none'" style="margin-top:30px; width:100%; padding:15px; border-radius:15px; background:var(--border); color:#fff; cursor:pointer;">CLOSE</button>
        </div>
    </div>

    <script>
        // --- Persistence & State ---
        let state = JSON.parse(localStorage.getItem('kmg_v12_state')) || {
            monthly: [{ id: 1, text: "ÏïàÌã∞Í∑∏ÎûòÎπÑÌã∞ ÏÉÅÏö©Ìôî ÌîÑÎ°úÏ†ùÌä∏", date: "2026-02-13", done: false }],
            weekly: [{ id: 101, text: "Ïä§ÌÅ¨Îüº ÎåÄÏãúÎ≥¥Îìú Í≥†ÎèÑÌôî", day: "Fri", parentId: 1, prio: "high", done: false }],
            daily: [{ id: 1001, text: "Í≥ÑÏ∏µÌòï Îç∞Ïù¥ÌÑ∞ Î°úÏßÅ Íµ¨ÌòÑ", time: "21:40", parentId: 101, done: false }]
        };

        // --- Mouse Effect ---
        function handleMouse(e) {
            const wand = document.getElementById('wand');
            wand.style.left = e.clientX + 'px';
            wand.style.top = e.clientY + 'px';
        }

        // --- Tabs ---
        function switchTab(t) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`v-${t}`).className = 'view-section active';
            event.currentTarget.className = 'nav-btn active';
            if(t === 'daily') renderDaily();
            if(t === 'weekly') renderWeekly();
            if(t === 'monthly') renderMonthly();
        }

        // --- Monthly (ÎåÄ) ---
        function renderMonthly() {
            const grid = document.getElementById('cal-grid');
            grid.innerHTML = '';
            const labels = ["S","M","T","W","T","F","S"];
            labels.forEach(l => grid.innerHTML += `<div class="cal-day-label">${l}</div>`);

            const year=2026, month=1;
            const days = new Date(year, month+1, 0).getDate();
            const firstDay = new Date(year, month, 1).getDay();

            const holidays = {"2026-02-17": "ÏÑ§ÎÇ†"};

            for(let i=0; i<firstDay; i++) grid.innerHTML += `<div></div>`;
            for(let i=1; i<=days; i++) {
                const dateStr = `2026-02-${String(i).padStart(2,'0')}`;
                const items = state.monthly.filter(m => m.date === dateStr);
                const holiday = holidays[dateStr];
                
                let html = `<div class="cal-cell ${holiday ? 'holiday' : ''}"><b>${i}</b>${holiday ? '<span style="font-size:0.5rem;">'+holiday+'</span>':''}`;
                items.forEach(item => {
                    html += `<div class="m-item ${item.done?'done':''}" onclick="toggleMonthly(${item.id})">${item.text}</div>`;
                });
                html += `</div>`;
                grid.innerHTML += html;
            }
            updateSelectors();
            save();
        }

        function addMonthly() {
            const date = document.getElementById('m-date').value;
            const txt = document.getElementById('m-txt').value;
            if(!date || !txt) return;
            state.monthly.push({ id: Date.now(), text: txt, date, done: false });
            renderMonthly();
        }
        function toggleMonthly(id) {
            const item = state.monthly.find(m => m.id === id);
            item.done = !item.done;
            renderMonthly();
        }

        // --- Weekly (Ï§ë) ---
        function renderWeekly() {
            const root = document.getElementById('weekly-list');
            root.innerHTML = '';
            state.weekly.forEach(w => {
                const parent = state.monthly.find(m => m.id == w.parentId);
                const parentText = parent ? parent.text : "ETC";
                root.innerHTML += `
                    <div class="card ${w.done?'done':''}">
                        <div class="check-ring" onclick="toggleWeekly(${w.id})">${w.done?'‚úì':''}</div>
                        <div style="flex:1;">
                            <span class="c-parent">${w.day} | PARENT: ${parentText}</span>
                            <span class="c-text">${w.text}</span>
                        </div>
                        <button onclick="delItem('weekly', ${w.id})" style="background:transparent; border:none; color:var(--danger); cursor:pointer;">‚úï</button>
                    </div>
                `;
            });
            updateSelectors();
            save();
        }
        function addWeekly() {
            const day = document.getElementById('w-day').value;
            const txt = document.getElementById('w-txt').value;
            const prio = document.getElementById('w-prio').value;
            const parentId = document.getElementById('w-parent').value;
            if(!txt) return;
            state.weekly.push({ id: Date.now(), text: txt, day, parentId, prio, done: false });
            renderWeekly();
        }
        function toggleWeekly(id) {
            const item = state.weekly.find(w => w.id === id);
            item.done = !item.done;
            renderWeekly();
        }

        // --- Daily (ÏÜå) ---
        function renderDaily() {
            const root = document.getElementById('daily-list');
            root.innerHTML = '';
            state.daily.forEach(d => {
                const parent = state.weekly.find(w => w.id == d.parentId);
                const parentText = parent ? parent.text : "ETC";
                root.innerHTML += `
                    <div class="card ${d.done?'done':''}">
                        <div class="check-ring" onclick="toggleDaily(${d.id})">${d.done?'‚úì':''}</div>
                        <div style="flex:1;">
                            <span class="c-parent">${d.time} | PARENT: ${parentText}</span>
                            <span class="c-text">${d.text}</span>
                        </div>
                        <button onclick="delItem('daily', ${d.id})" style="background:transparent; border:none; color:var(--danger); cursor:pointer;">‚úï</button>
                    </div>
                `;
            });
            save();
        }
        function addDaily() {
            const time = document.getElementById('d-time').value;
            const txt = document.getElementById('d-txt').value;
            const parentId = document.getElementById('d-parent').value;
            if(!txt) return;
            state.daily.push({ id: Date.now(), text: txt, time, parentId, done: false });
            renderDaily();
        }
        function toggleDaily(id) {
            const item = state.daily.find(d => d.id === id);
            item.done = !item.done;
            renderDaily();
        }

        // --- Logic Engine ---
        function delItem(type, id) {
            state[type] = state[type].filter(i => i.id !== id);
            if(type === 'monthly') {
                state.weekly.forEach(w => { if(w.parentId == id) w.parentId = 'ETC'; });
            }
            if(type === 'weekly') {
                state.daily.forEach(d => { if(d.parentId == id) d.parentId = 'ETC'; });
            }
            if(type === 'daily') renderDaily();
            if(type === 'weekly') renderWeekly();
            if(type === 'monthly') renderMonthly();
        }

        function updateSelectors() {
            const wParent = document.getElementById('w-parent');
            wParent.innerHTML = `<option value="ETC">ETC (ÏÉÅÏúÑÏóÜÏùå)</option>`;
            state.monthly.forEach(m => wParent.innerHTML += `<option value="${m.id}">${m.text}</option>`);

            const dParent = document.getElementById('d-parent');
            dParent.innerHTML = `<option value="ETC">ETC (ÏÉÅÏúÑÏóÜÏùå)</option>`;
            state.weekly.forEach(w => dParent.innerHTML += `<option value="${w.id}">${w.text}</option>`);
        }

        // --- Timer ---
        let timerRem = 1500, timerOn = false, timerInt;
        function toggleTimer() {
            const btn = document.getElementById('t-toggle');
            if(timerOn) { clearInterval(timerInt); btn.textContent = 'START'; }
            else {
                timerInt = setInterval(() => {
                    timerRem--;
                    updateTimerUI();
                    if(timerRem <= 0) { clearInterval(timerInt); alert("FOCUS END"); }
                }, 1000);
                btn.textContent = 'PAUSE';
            }
            timerOn = !timerOn;
        }
        function resetTimer() {
            clearInterval(timerInt); timerOn = false;
            const set = document.getElementById('timer-set').value;
            timerRem = set ? set * 60 : 1500;
            updateTimerUI();
            document.getElementById('t-toggle').textContent = 'START';
        }
        function updateTimerUI() {
            const m = Math.floor(timerRem / 60); const s = timerRem % 60;
            document.getElementById('timer-txt').textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        }

        // --- Utils ---
        function save() { localStorage.setItem('kmg_v12_state', JSON.stringify(state)); }
        function genReport(view) {
            const m = document.getElementById('modal');
            const mt = document.getElementById('m-title');
            const mc = document.getElementById('m-content');
            m.style.display = 'flex';
            mt.textContent = `${view.toUpperCase()} SCRUM REPORT`;
            
            const list = state[view];
            const done = list.filter(i => i.done).length;
            mc.innerHTML = `ÌòÑÏû¨ ${view} Îã®Í≥ÑÏùò ÏßÑÏ≤ôÎèÑÎäî **${Math.round(done/list.length*100) || 0}%** ÏûÖÎãàÎã§.<br><br>`;
            list.forEach(i => mc.innerHTML += `‚Ä¢ [${i.done?'ÏôÑÎ£å':'ÎØ∏ÏôÑ'}] ${i.text}<br>`);
        }

        async function fetchNews() {
            try {
                const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent('https://news.google.com/rss/search?q=AI&hl=ko&gl=KR&ceid=KR:ko')}`);
                const data = await res.json();
                const root = document.getElementById('news-root');
                root.innerHTML = '';
                data.items.slice(0, 5).forEach(i => root.innerHTML += `<a href="${i.link}" target="_blank" style="color:#eee; font-size:0.75rem; text-decoration:none;">‚Ä¢ ${i.title}</a>`);
            } catch(e) {}
        }

        function sync() {
            const n = new Date();
            document.getElementById('b-clock').textContent = `${String(n.getHours()).padStart(2,'0')}:${String(n.getMinutes()).padStart(2,'0')}`;
            document.getElementById('b-date').textContent = n.toLocaleDateString('en-US', {month:'short', day:'numeric', weekday:'short'});
        }

        function init() {
            renderDaily();
            updateSelectors();
            setInterval(sync, 1000);
            fetchNews();
        }
        init();
    </script>
</body>
</html>
